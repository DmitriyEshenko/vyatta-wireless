tag:
type: txt
help: Set wireless network interface
comp_help: Enter wireless network interface name (wlan0 - wlan99)
syntax:expression: pattern $VAR(@) "^wlan[0-9]+$" ; \
	 "Must be (wlan0 - wlan999)"

create: if [ ! -d /sys/class/net/$VAR(@) ]; then
	    /opt/vyatta/sbin/wireless-config.pl --dev=$VAR(@) --create || exit 1
	fi
	sudo ip link set $VAR(@) up
	/opt/vyatta/sbin/vyatta-link-detect $VAR(@) on

delete: [ -d /sys/class/net/$VAR(@) ] || exit 0
	sudo /opt/vyatta/sbin/hostapd-init stop $VAR(@)
        sudo ip link set $VAR(@) down
	/opt/vyatta/sbin/wireless-config.pl --dev=$VAR(@) --delete

end: if [ "$VAR(./type/@)" = "access-point" ]; then
         case ${COMMIT_ACTION} in
     	 SET)    /opt/vyatta/sbin/hostapd-init start $VAR(@) ;;
	 ACTIVE) /opt/vyatta/sbin/hostapd-init reload $VAR(@) ;;
         esac
     fi
